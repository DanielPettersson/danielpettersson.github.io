<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Rubik</title>
		<style>
			body { margin: 0; }
			canvas { display: block; }
		</style>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/16.3.5/Tween.min.js"></script>

    </head>
    
	<body>

		<script type="module">

            import * as THREE from 'https://cdn.skypack.dev/three';
            import { RoundedBoxGeometry } from 'https://cdn.skypack.dev/three/examples/jsm/geometries/RoundedBoxGeometry.js';
          
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );
            camera.position.set(3, 2, 5);
            camera.lookAt(0, 0, 0);

            const light = new THREE.DirectionalLight();
            light.position.set( 1, 1, 1 );
            scene.add( light )

            const light2 = new THREE.DirectionalLight(0xffffbb, 0.5);
            light2.position.set( -2, 0, 1 );
            scene.add( light2 )

            const geometry = new RoundedBoxGeometry();
            const material = new THREE.MeshStandardMaterial( { color: 0xffffff } );

            const pivot = new THREE.Object3D();

            for (var x = -1; x <= 1; x++) {
                for (var y = -1; y <= 1; y++) {
                    for (var z = -1; z <= 1; z++) {
                        if (x == 0 && y == 0 && z == 0) continue;
                        const cube = new THREE.Mesh( geometry, material );
                        cube.position.set(x, y, z);
                        
                        if (x == 1) {
                            pivot.add(cube);
                        } else {
                            scene.add(cube);
                        }
                    }
                }
            }

            scene.add(pivot);


            window.addEventListener( 'resize', function() {
                renderer.setSize(window.innerWidth, window.innerHeight);
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
            }, false );


            var position = { x : 0 };
            var target = { x : Math.PI / 2 };
            var tween = new TWEEN.Tween(position)
                                 .to(target, 1000)
                                 .onUpdate(function() { pivot.rotation.x = this.x })
                                 .easing(TWEEN.Easing.Quartic.InOut)
                                 .repeat(Infinity)
                                 .start();

            function render(time) {

                requestAnimationFrame(render);

                renderer.render(scene, camera);
                TWEEN.update(time);
                
            }


            requestAnimationFrame(render);
          
          </script>

	</body>
</html>